2024-05-10 21:00:46.135 | INFO     | agentscope.models:read_model_configs:170 - Load configs for model wrapper: qwen-max, qwen-turbo
2024-05-10 21:00:46.146 | INFO     | agentscope.utils.monitor:_create_monitor_table:396 - Init [monitor_metrics] as the monitor table
2024-05-10 21:00:46.147 | INFO     | agentscope.utils.monitor:_create_monitor_table:397 - Init [monitor_metrics_quota_exceeded] as the monitor trigger
2024-05-10 21:00:46.147 | INFO     | agentscope.utils.monitor:__init__:366 - SqliteMonitor initialization completed at [./runs\run_20240510-210043_lydf39\agentscope.db]
2024-05-10 21:00:55.594 | INFO     | app.services.utils:retrieve_photo_message:75 - 查询条件如下：(Q(**{'user_id': '001'}) & Q(**{'related_photo_id': '66361994e8eb220e315529d7'}) & Q(**{'timestamp__gte': datetime.datetime(1, 1, 1, 0, 0)}) & Q(**{'timestamp__lte': datetime.datetime(2024, 5, 10, 21, 0, 55, 594965)}))
2024-05-10 21:00:55.598 | INFO     | app.services.utils:retrieve_photo_message:79 - 查询结果如下：[<Message: Message object>]
2024-05-10 21:00:55.602 | INFO     | app.api.routes:get_photo_message:124 - retrieved message:[<Message: Message object>]
2024-05-10 21:00:55.606 | INFO     | app.api.routes:get_photo_message:133 - message list:[{'sender': 'assistant', 'message_type': 'text', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，首先浮现在脑海里的是什么场景呢？', 'timestamp': '2024-05-10 19:59:55', 'related_photo_id': '66361994e8eb220e315529d7'}]
2024-05-10 21:00:55.607 | INFO     | app.api.routes:get_photo_message:134 - message json:<Response 489 bytes [200 OK]>
2024-05-10 21:01:17.778 | INFO     | app.api.routes:send_message:46 - user message added:fMessage object
2024-05-10 21:01:17.779 | INFO     | app.services.utils:retrieve_photo_message:75 - 查询条件如下：(Q(**{'user_id': '001'}) & Q(**{'related_photo_id': '66361994e8eb220e315529d7'}) & Q(**{'timestamp__gte': datetime.datetime(1, 1, 1, 0, 0)}) & Q(**{'timestamp__lte': datetime.datetime(2024, 5, 10, 21, 1, 17, 779127)}))
2024-05-10 21:01:17.781 | INFO     | app.services.utils:retrieve_photo_message:79 - 查询结果如下：[<Message: Message object>, <Message: Message object>]
2024-05-10 21:01:17.785 | INFO     | app.api.routes:send_message:59 - message list: [{'sender': 'assistant', 'message_type': 'text', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，首先浮现在脑海里的是什么场景呢？', 'timestamp': '2024-05-10 19:59:55', 'related_photo_id': '66361994e8eb220e315529d7'}, {'sender': 'user', 'message_type': 'text', 'content': '当时有很多人在附近打太极拳', 'timestamp': '2024-05-10 21:01:17', 'related_photo_id': '66361994e8eb220e315529d7'}]
2024-05-10 21:01:17.786 | INFO     | app.api.routes:send_message:63 - photo description: 照片的标题是：北京天坛；照片的描述是：A test photo。
2024-05-10 21:01:17.786 | INFO     | app.services.ai_agent:conversation:45 - in Agent.conversation the prompt is:{'messages': [{'role': 'system', 'content': '\n你是一位心理疗愈师，你的任务是通过对照片的讨论，帮助用户回忆他们经历过的历史事件。照片的详细信息会在稍后提到。\n你需要引导用户深入地回忆这个照片背后的故事，包括照片中的人物、地点、时间、感受以及和照片相关的印象深刻的事情，例如可能是一次旅游，可能是一次聚会。\n在这个过程中，可以适当地重复照片相关信息，以便帮助用户更好地回忆。\n你的目标是通过这种深度对话，帮助用户提升他们的认知水平。\n请注意，你需要尊重用户的感受，避免触及他们可能不愿意谈论的敏感话题。同时，你也需要保持专业，避免给出任何可能被误解为医疗建议的信息。\n在这个过程中，请表现的更加亲切和理解对方，以便让用户更容易打开心扉。\n\n下面是我们目前已知的和照片相关的信息，可能过于简略，如果缺少信息，请主动向用户提问。但注意一次只提一个问题。下面是照片的信息：照片的标题是：北京天坛；照片的描述是：A test photo。'}, {'role': 'assistant', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，首先浮现在脑海里的是什么场景呢？'}, {'role': 'user', 'content': '当时有很多人在附近打太极拳'}]}
2024-05-10 21:01:17.786 | INFO     | app.services.llm_models:call_model:62 - in call_model, the body is{'model': 'qwen-turbo', 'input': {'messages': [{'role': 'system', 'content': '\n你是一位心理疗愈师，你的任务是通过对照片的讨论，帮助用户回忆他们经历过的历史事件。照片的详细信息会在稍后提到。\n你需要引导用户深入地回忆这个照片背后的故事，包括照片中的人物、地点、时间、感受以及和照片相关的印象深刻的事情，例如可能是一次旅游，可能是一次聚会。\n在这个过程中，可以适当地重复照片相关信息，以便帮助用户更好地回忆。\n你的目标是通过这种深度对话，帮助用户提升他们的认知水平。\n请注意，你需要尊重用户的感受，避免触及他们可能不愿意谈论的敏感话题。同时，你也需要保持专业，避免给出任何可能被误解为医疗建议的信息。\n在这个过程中，请表现的更加亲切和理解对方，以便让用户更容易打开心扉。\n\n下面是我们目前已知的和照片相关的信息，可能过于简略，如果缺少信息，请主动向用户提问。但注意一次只提一个问题。下面是照片的信息：照片的标题是：北京天坛；照片的描述是：A test photo。'}, {'role': 'assistant', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，首先浮现在脑海里的是什么场景呢？'}, {'role': 'user', 'content': '当时有很多人在附近打太极拳'}]}}
2024-05-10 21:01:20.874 | ERROR    | app.api.routes:send_message:82 - HTTPSConnectionPool(host='dashscope.aliyuncs.com', port=443): Max retries exceeded with url: /api/v1/services/aigc/text-generation/generation (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2024-05-10 21:03:02.305 | INFO     | app.services.utils:retrieve_photo_message:75 - 查询条件如下：(Q(**{'user_id': '001'}) & Q(**{'related_photo_id': '66361994e8eb220e315529d7'}) & Q(**{'timestamp__gte': datetime.datetime(1, 1, 1, 0, 0)}) & Q(**{'timestamp__lte': datetime.datetime(2024, 5, 10, 21, 3, 2, 305431)}))
2024-05-10 21:03:02.310 | INFO     | app.services.utils:retrieve_photo_message:79 - 查询结果如下：[<Message: Message object>, <Message: Message object>]
2024-05-10 21:03:02.314 | INFO     | app.api.routes:get_photo_message:124 - retrieved message:[<Message: Message object>, <Message: Message object>]
2024-05-10 21:03:02.318 | INFO     | app.api.routes:get_photo_message:133 - message list:[{'sender': 'user', 'message_type': 'text', 'content': '当时有很多人在附近打太极拳', 'timestamp': '2024-05-10 21:01:17', 'related_photo_id': '66361994e8eb220e315529d7'}, {'sender': 'assistant', 'message_type': 'text', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，首先浮现在脑海里的是什么场景呢？', 'timestamp': '2024-05-10 19:59:55', 'related_photo_id': '66361994e8eb220e315529d7'}]
2024-05-10 21:03:02.318 | INFO     | app.api.routes:get_photo_message:134 - message json:<Response 736 bytes [200 OK]>
2024-05-10 21:03:17.709 | INFO     | app.services.utils:retrieve_photo_message:75 - 查询条件如下：(Q(**{'user_id': '001'}) & Q(**{'related_photo_id': '66361994e8eb220e315529d7'}) & Q(**{'timestamp__gte': datetime.datetime(1, 1, 1, 0, 0)}) & Q(**{'timestamp__lte': datetime.datetime(2024, 5, 10, 21, 3, 17, 709331)}))
2024-05-10 21:03:17.713 | INFO     | app.services.utils:retrieve_photo_message:79 - 查询结果如下：[<Message: Message object>]
2024-05-10 21:03:17.725 | INFO     | app.api.routes:get_photo_message:124 - retrieved message:[<Message: Message object>]
2024-05-10 21:03:17.727 | INFO     | app.api.routes:get_photo_message:133 - message list:[{'sender': 'user', 'message_type': 'text', 'content': '当时有很多人在附近打太极拳', 'timestamp': '2024-05-10 21:01:17', 'related_photo_id': '66361994e8eb220e315529d7'}]
2024-05-10 21:03:17.727 | INFO     | app.api.routes:get_photo_message:134 - message json:<Response 250 bytes [200 OK]>
2024-05-10 21:03:34.889 | INFO     | app.services.utils:retrieve_photo_message:75 - 查询条件如下：(Q(**{'user_id': '001'}) & Q(**{'related_photo_id': '66361994e8eb220e315529d7'}) & Q(**{'timestamp__gte': datetime.datetime(1, 1, 1, 0, 0)}) & Q(**{'timestamp__lte': datetime.datetime(2024, 5, 10, 21, 3, 34, 889037)}))
2024-05-10 21:03:34.892 | INFO     | app.services.utils:retrieve_photo_message:79 - 查询结果如下：[]
2024-05-10 21:03:34.897 | INFO     | app.api.routes:get_photo_message:109 - messages not found
2024-05-10 21:03:34.902 | INFO     | app.services.ai_agent:photo_message_init:65 - prompt is:{'messages': [{'role': 'system', 'content': '\n你是一位心理疗愈师，你的任务是通过对照片的讨论，帮助用户回忆他们经历过的历史事件。照片的详细信息会在稍后提到。\n你需要引导用户深入地回忆这个照片背后的故事，包括照片中的人物、地点、时间、感受以及和照片相关的印象深刻的事情，例如可能是一次旅游，可能是一次聚会。\n在这个过程中，可以适当地重复照片相关信息，以便帮助用户更好地回忆。\n你的目标是通过这种深度对话，帮助用户提升他们的认知水平。\n请注意，你需要尊重用户的感受，避免触及他们可能不愿意谈论的敏感话题。同时，你也需要保持专业，避免给出任何可能被误解为医疗建议的信息。\n在这个过程中，请表现的更加亲切和理解对方，以便让用户更容易打开心扉。\n\n下面是我们目前已知的和照片相关的信息，可能过于简略，如果缺少信息，请主动向用户提问。但注意一次只提一个问题。下面是照片的信息：照片的标题是：北京天坛；照片的描述是：A test photo。'}, {'role': 'user', 'content': '请以"让我们开启这张照片的回忆吧"开头，开始提问'}]}
2024-05-10 21:03:34.903 | INFO     | app.services.llm_models:call_model:62 - in call_model, the body is{'model': 'qwen-max', 'input': {'messages': [{'role': 'system', 'content': '\n你是一位心理疗愈师，你的任务是通过对照片的讨论，帮助用户回忆他们经历过的历史事件。照片的详细信息会在稍后提到。\n你需要引导用户深入地回忆这个照片背后的故事，包括照片中的人物、地点、时间、感受以及和照片相关的印象深刻的事情，例如可能是一次旅游，可能是一次聚会。\n在这个过程中，可以适当地重复照片相关信息，以便帮助用户更好地回忆。\n你的目标是通过这种深度对话，帮助用户提升他们的认知水平。\n请注意，你需要尊重用户的感受，避免触及他们可能不愿意谈论的敏感话题。同时，你也需要保持专业，避免给出任何可能被误解为医疗建议的信息。\n在这个过程中，请表现的更加亲切和理解对方，以便让用户更容易打开心扉。\n\n下面是我们目前已知的和照片相关的信息，可能过于简略，如果缺少信息，请主动向用户提问。但注意一次只提一个问题。下面是照片的信息：照片的标题是：北京天坛；照片的描述是：A test photo。'}, {'role': 'user', 'content': '请以"让我们开启这张照片的回忆吧"开头，开始提问'}]}}
2024-05-10 21:03:40.209 | INFO     | app.api.routes:get_photo_message:120 - message added:fMessage object
2024-05-10 21:03:40.211 | INFO     | app.services.utils:retrieve_photo_message:75 - 查询条件如下：(Q(**{'user_id': '001'}) & Q(**{'related_photo_id': '66361994e8eb220e315529d7'}) & Q(**{'timestamp__gte': datetime.datetime(1, 1, 1, 0, 0)}) & Q(**{'timestamp__lte': datetime.datetime(2024, 5, 10, 21, 3, 40, 211139)}))
2024-05-10 21:03:40.213 | INFO     | app.services.utils:retrieve_photo_message:79 - 查询结果如下：[<Message: Message object>]
2024-05-10 21:03:40.213 | INFO     | app.api.routes:get_photo_message:124 - retrieved message:[<Message: Message object>]
2024-05-10 21:03:40.215 | INFO     | app.api.routes:get_photo_message:133 - message list:[{'sender': 'assistant', 'message_type': 'text', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，第一个浮现在脑海中的记忆是什么？', 'timestamp': '2024-05-10 21:03:40', 'related_photo_id': '66361994e8eb220e315529d7'}]
2024-05-10 21:03:40.215 | INFO     | app.api.routes:get_photo_message:134 - message json:<Response 489 bytes [200 OK]>
2024-05-10 21:04:08.687 | INFO     | app.api.routes:send_message:46 - user message added:fMessage object
2024-05-10 21:04:08.689 | INFO     | app.services.utils:retrieve_photo_message:75 - 查询条件如下：(Q(**{'user_id': '001'}) & Q(**{'related_photo_id': '66361994e8eb220e315529d7'}) & Q(**{'timestamp__gte': datetime.datetime(1, 1, 1, 0, 0)}) & Q(**{'timestamp__lte': datetime.datetime(2024, 5, 10, 21, 4, 8, 689692)}))
2024-05-10 21:04:08.692 | INFO     | app.services.utils:retrieve_photo_message:79 - 查询结果如下：[<Message: Message object>, <Message: Message object>]
2024-05-10 21:04:08.700 | INFO     | app.api.routes:send_message:59 - message list: [{'sender': 'assistant', 'message_type': 'text', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，第一个浮现在脑海中的记忆是什么？', 'timestamp': '2024-05-10 21:03:40', 'related_photo_id': '66361994e8eb220e315529d7'}, {'sender': 'user', 'message_type': 'text', 'content': '天气非常好，周围很多人在锻炼身体。', 'timestamp': '2024-05-10 21:04:08', 'related_photo_id': '66361994e8eb220e315529d7'}]
2024-05-10 21:04:08.701 | INFO     | app.api.routes:send_message:63 - photo description: 照片的标题是：北京天坛；照片的描述是：A test photo。
2024-05-10 21:04:08.701 | INFO     | app.services.ai_agent:conversation:45 - in Agent.conversation the prompt is:{'messages': [{'role': 'system', 'content': '\n你是一位心理疗愈师，你的任务是通过对照片的讨论，帮助用户回忆他们经历过的历史事件。照片的详细信息会在稍后提到。\n你需要引导用户深入地回忆这个照片背后的故事，包括照片中的人物、地点、时间、感受以及和照片相关的印象深刻的事情，例如可能是一次旅游，可能是一次聚会。\n在这个过程中，可以适当地重复照片相关信息，以便帮助用户更好地回忆。\n你的目标是通过这种深度对话，帮助用户提升他们的认知水平。\n请注意，你需要尊重用户的感受，避免触及他们可能不愿意谈论的敏感话题。同时，你也需要保持专业，避免给出任何可能被误解为医疗建议的信息。\n在这个过程中，请表现的更加亲切和理解对方，以便让用户更容易打开心扉。\n\n下面是我们目前已知的和照片相关的信息，可能过于简略，如果缺少信息，请主动向用户提问。但注意一次只提一个问题。下面是照片的信息：照片的标题是：北京天坛；照片的描述是：A test photo。'}, {'role': 'assistant', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，第一个浮现在脑海中的记忆是什么？'}, {'role': 'user', 'content': '天气非常好，周围很多人在锻炼身体。'}]}
2024-05-10 21:04:08.702 | INFO     | app.services.llm_models:call_model:62 - in call_model, the body is{'model': 'qwen-turbo', 'input': {'messages': [{'role': 'system', 'content': '\n你是一位心理疗愈师，你的任务是通过对照片的讨论，帮助用户回忆他们经历过的历史事件。照片的详细信息会在稍后提到。\n你需要引导用户深入地回忆这个照片背后的故事，包括照片中的人物、地点、时间、感受以及和照片相关的印象深刻的事情，例如可能是一次旅游，可能是一次聚会。\n在这个过程中，可以适当地重复照片相关信息，以便帮助用户更好地回忆。\n你的目标是通过这种深度对话，帮助用户提升他们的认知水平。\n请注意，你需要尊重用户的感受，避免触及他们可能不愿意谈论的敏感话题。同时，你也需要保持专业，避免给出任何可能被误解为医疗建议的信息。\n在这个过程中，请表现的更加亲切和理解对方，以便让用户更容易打开心扉。\n\n下面是我们目前已知的和照片相关的信息，可能过于简略，如果缺少信息，请主动向用户提问。但注意一次只提一个问题。下面是照片的信息：照片的标题是：北京天坛；照片的描述是：A test photo。'}, {'role': 'assistant', 'content': '让我们开启这张照片的回忆吧。这张照片的标题是北京天坛，您看到这张照片时，第一个浮现在脑海中的记忆是什么？'}, {'role': 'user', 'content': '天气非常好，周围很多人在锻炼身体。'}]}}
2024-05-10 21:04:11.278 | ERROR    | app.api.routes:send_message:82 - ValidationError (Message:None) (Field is required: ['content'])
